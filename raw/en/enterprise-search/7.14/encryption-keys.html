<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Configure encryption keys | Elastic Enterprise Search Documentation [7.14] | Elastic</title>
<link rel="home" href="index.html" title="Elastic Enterprise Search Documentation [7.14]"/>
<link rel="up" href="configuration.html" title="Configuration"/>
<link rel="prev" href="configuration.html" title="Configuration"/>
<link rel="next" href="mailer-configuration.html" title="Configure a mail service"/>
<meta name="DC.type" content="Learn/Docs/Enterprise Search/Guide/7.14"/>
<meta name="DC.subject" content="Enterprise Search"/>
<meta name="DC.identifier" content="7.14"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="index.html">Elastic Enterprise Search Documentation [7.14]</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="configuration.html">Configuration</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="configuration.html">« Configuration</a>
</span>
<span class="next">
<a href="mailer-configuration.html">Configure a mail service »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="encryption-keys"></a>Configure encryption keys<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/7.14/enterprise-search-docs/configuration/encryption-keys.asciidoc">edit</a></h2>
</div></div></div>
<p>Enterprise Search is designed to keep synchronization information and access tokens secure at all times. To ensure safe storage of credentials and other secrets, <span class="strong strong"><strong>encryption keys must be provided when starting and deploying the service</strong></span>.</p>
<p>To configure encryption keys, locate the <code class="literal">config/enterprise-search.yml</code> configuration file in the Enterprise Search directory, and set a <code class="literal">secret_management.encryption_keys</code> value:</p>
<div class="pre_wrapper lang-yml">
<pre class="programlisting prettyprint lang-yml">secret_management.encryption_keys: [{encryption_key1}, {encryption_key2}, {...}]</pre>
</div>
<p><code class="literal">secret_management.encryption_keys</code> requires an array of values with at least one encryption key. We recommend rotating encryption keys over time, and Enterprise Search lets you set multiple encryption keys to enable proper security practices.</p>
<p>Should an encryption key be misplaced or lost, the encrypted access tokens and source synchronization credentials will no longer be accessible, and content synchronization will be halted for all sources until they are re-authenticated.</p>
<p>When a new value is added to the <code class="literal">encryption_keys</code> aray, Enterprise Search will attempt to decrypt secrets from the first entry, moving across the array until success. Secrets are re-encrypted with the last key in the array when rewritten.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>We strongly recommend using 256-bit encryption key values, and rotating keys on a regular basis.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_generating_encryption_keys"></a>Generating encryption keys<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/7.14/enterprise-search-docs/configuration/encryption-keys.asciidoc">edit</a></h3>
</div></div></div>
<p>There are several techniques for generating secure random 256-bit encryption keys.</p>
<p>On systems with <code class="literal">openssl</code> installed, run:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">openssl rand -hex 32</pre>
</div>
<p>Or on Linux environments without <code class="literal">openssl</code>, including empty docker containers for CentOS, Ubuntu, Debian, Alpine and even in a busybox environment, run this command:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">od  -vN 32 -An -tx1 /dev/urandom | tr -d " \n" ; echo</pre>
</div>
<p>If you do not specify a <code class="literal">secret_management.encryption_keys</code> value in the <code class="literal">config/enterprise-search.yml</code> file and run Enterprise Search, Enterprise Search will fail to start. But before failing, Enterprise Search will generate and display an example encryption key that you can copy and paste into the configuration file.</p>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="configuration.html">« Configuration</a>
</span>
<span class="next">
<a href="mailer-configuration.html">Configure a mail service »</a>
</span>
</div>
</div>
</body>
</html>
