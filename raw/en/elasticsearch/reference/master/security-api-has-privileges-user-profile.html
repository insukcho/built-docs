<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Has privileges user profile API | Elasticsearch Guide [master] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Guide [master]"/>
<link rel="up" href="security-api.html" title="Security APIs"/>
<link rel="prev" href="security-api-update-user-profile-data.html" title="Update user profile data API"/>
<link rel="next" href="snapshot-restore-apis.html" title="Snapshot and restore APIs"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [master]</a></span>
»
<span class="breadcrumb-link"><a href="rest-apis.html">REST APIs</a></span>
»
<span class="breadcrumb-link"><a href="security-api.html">Security APIs</a></span>
»
<span class="breadcrumb-node">Has privileges user profile API</span>
</div>
<div class="navheader">
<span class="prev">
<a href="security-api-update-user-profile-data.html">« Update user profile data API</a>
</span>
<span class="next">
<a href="snapshot-restore-apis.html">Snapshot and restore APIs »</a>
</span>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-has-privileges-user-profile"></a>Has privileges user profile API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/x-pack/docs/en/rest-api/security/has-privileges-user-profile.asciidoc">edit</a></h2>
</div></div></div>

<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p>Determines whether the users associated with the specified <a class="xref" href="user-profile.html" title="User profiles">user profile</a> IDs
have all the requested privileges.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-has-privileges-user-profile-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/x-pack/docs/en/rest-api/security/has-privileges-user-profile.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET /_security/profile/_has_privileges</code></p>
<p><code class="literal">POST /_security/profile/_has_privileges</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-has-privileges-user-profile-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/x-pack/docs/en/rest-api/security/has-privileges-user-profile.asciidoc">edit</a></h3>
</div></div></div>
<p>To use this API, you must have the <code class="literal">manage_user_profile</code> cluster privilege.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-has-privileges-user-profile-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/x-pack/docs/en/rest-api/security/has-privileges-user-profile.asciidoc">edit</a></h3>
</div></div></div>
<p>This API uses the profile IDs, as returned by <a class="xref" href="security-api-activate-user-profile.html" title="Activate user profile API">Activate user profile</a>,
to identify the users for which to check the privileges of.
It is similar to the <a class="xref" href="security-api-has-privileges.html" title="Has privileges API">Has privileges</a> API, but unlike it, this API
checks the privileges of other users, not of the user that&#8217;s calling it.</p>
<p>See <a class="xref" href="security-privileges.html" title="Security privileges">Security privileges</a> for the list of privileges that can be specified in this API.</p>
<p>A successful call returns the subset list of profile IDs that have <span class="strong strong"><strong>all</strong></span> the requested privileges.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-has-privileges-user-profile-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/x-pack/docs/en/rest-api/security/has-privileges-user-profile.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">uids</code>
</span>
</dt>
<dd>
(list) A list of <a class="xref" href="security-api-activate-user-profile.html#security-api-activate-user-profile-response-body" title="Response body">profile IDs</a>. The privileges are checked for associated users of the profiles.
</dd>
<dt>
<span class="term">
<code class="literal">privileges</code>
</span>
</dt>
<dd>
<p>
The object containing all the privileges to be checked.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">cluster</code>
</span>
</dt>
<dd>
(list) A list of the cluster privileges that you want to check.
</dd>
<dt>
<span class="term">
<code class="literal">index</code>
</span>
</dt>
<dd>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">names</code>
</span>
</dt>
<dd>
(list) A list of indices.
</dd>
<dt>
<span class="term">
<code class="literal">allow_restricted_indices</code>
</span>
</dt>
<dd>
(Boolean) This needs to be set to <code class="literal">true</code> (default
is <code class="literal">false</code>) if using wildcards or regexps for patterns that cover restricted
indices. Implicitly, restricted indices do not match index patterns because
restricted indices usually have limited privileges and including them in
pattern tests would render most such tests <code class="literal">false</code>. If restricted indices are
explicitly included in the <code class="literal">names</code> list, privileges will be checked against
them regardless of the value of <code class="literal">allow_restricted_indices</code>.
</dd>
<dt>
<span class="term">
<code class="literal">privileges</code>
</span>
</dt>
<dd>
(list) A list of the privileges that you want to check for the
specified indices.
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">application</code>
</span>
</dt>
<dd>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">application</code>
</span>
</dt>
<dd>
(string) The name of the application.
</dd>
<dt>
<span class="term">
<code class="literal">privileges</code>
</span>
</dt>
<dd>
(list) A list of the privileges that you want to check for the
specified resources. May be either application privilege names, or the names of
actions that are granted by those privileges.
</dd>
<dt>
<span class="term">
<code class="literal">resources</code>
</span>
</dt>
<dd>
(list) A list of resource names against which the privileges
should be checked.
</dd>
</dl>
</div>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
<p>Note that the <code class="literal">privileges</code> section above is identical to the
<a class="xref" href="security-api-has-privileges.html#security-api-has-privileges-request-body" title="Request body">request body of the other Has Privileges API</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-has-privileges-user-profile-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/x-pack/docs/en/rest-api/security/has-privileges-user-profile.asciidoc">edit</a></h3>
</div></div></div>
<p>A successful has privileges user profile API call returns a JSON structure that contains
two list fields:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">has_privilege_uids</code>
</span>
</dt>
<dd>
(list) The subset of the requested profile IDs of the users that have
<span class="strong strong"><strong>all</strong></span> the requested privileges.
</dd>
<dt>
<span class="term">
<code class="literal">error_uids</code>
</span>
</dt>
<dd>
(list) The subset of the requested profile IDs for which an error was
encountered. It does <span class="strong strong"><strong>not</strong></span> include the missing profile IDs or the profile IDs of
the users that do not have all the requested privileges. This field is absent if empty.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-has-privileges-user-profile-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/x-pack/docs/en/rest-api/security/has-privileges-user-profile.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example checks whether the two users associated with the specified profiles have all the
requested set of cluster, index, and application privileges:</p>
<a id="8a3df7225e41b58e22ec5b13fc5047dc"></a>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/user/_has_privileges
{
  "uids": ["u_LQPnxDxEjIH0GOUoFkZr5Y57YUwSkL9Joiq-g4OCbPc_0", "u_rzRnxDgEHIH0GOUoFkZr5Y27YUwSk19Joiq=g4OCxxB_1"],
  "cluster": [ "monitor", "create_snapshot", "manage_ml" ],
  "index" : [
    {
      "names": [ "suppliers", "products" ],
      "privileges": [ "create_doc"]
    },
    {
      "names": [ "inventory" ],
      "privileges" : [ "read", "write" ]
    }
  ],
  "application": [
    {
      "application": "inventory_manager",
      "privileges" : [ "read", "data:write/inventory" ],
      "resources" : [ "product/1852563" ]
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2699.console"></div>
<p>The following example output indicates that only one of the two users has all the privileges:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "has_privilege_uids": ["u_rzRnxDgEHIH0GOUoFkZr5Y27YUwSk19Joiq=g4OCxxB_1"]
}</pre>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="security-api-update-user-profile-data.html">« Update user profile data API</a>
</span>
<span class="next">
<a href="snapshot-restore-apis.html">Snapshot and restore APIs »</a>
</span>
</div>
</div>
</body>
</html>
